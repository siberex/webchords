<link rel="import" href="node_modules/@polymer/polymer/polymer-element.html">


<dom-module id="tab-chord-finger-pos">

    <template>

        <style>

            :host {

                --string-distance: 30px;
                --string-thickness: 1px;

                --fret-distance: 40px;
                --fret-thickness: 2px;

                --dot-size: calc( var(--string-distance) * 0.65 );

                --dot-margin-left: calc( var(--dot-size) / -2 - 1px );

                --dot-margin-top: calc( (var(--fret-distance) - var(--dot-size)) / 2 );

            }

            .tab-chord-finger-pos {

                position: absolute;
                top: calc( var(--fret-distance) * ([[fret]] - 1) + var(--dot-margin-top) );
                /*left: calc( var(--string-distance) * [[stringIndex]] - var(--string-distance) / 2 + 1px );*/
                /*left: calc( var(--string-distance) * [[stringIndex]] - var(--dot-size) / 2 );*/
                left: calc( var(--string-distance) * ([[stringIndex]]) + var(--dot-margin-left) );

                background: #555;
                border: 1px solid black;

                width: var(--dot-size);
                height: var(--dot-size);
                border-radius: calc( var(--dot-size) / 2 );

                line-height: var(--dot-size);

                /*margin-top: var(--dot-margin-top);*/
                /*margin-left: var(--dot-margin-left);*/

                text-align: center;
                overflow: hidden;
            }

            .caption {
                display: none;
            }

        </style>


        <div class="tab-chord-finger-pos">
            <div class="caption"><slot></slot></div>
        </div>

    </template>


    <script>
        // Extend Polymer.Element base class
        // https://github.com/Polymer/polymer#20-es6-class-based-syntax
        class TabChordFingerPosition extends Polymer.Element {
            static get is() { return 'tab-chord-finger-pos'; }

            static get properties() {
                return {
                    string  : {
                        type    : Number,
                        value   : null,
                        notify  : false
                    },
                    fret    : {
                        type    : Number,
                        value   : null,
                        notify  : false
                    }
                };
            };

            static get observers() { return [ /* observer descriptors */ ] }



            constructor() {
                super();

                // The custom elements v1 specification forbids reading attributes, and accessing child or parent
                // information from the DOM API from the constructor. Likewise, attributes and children cannot be added.
                // You need to move any DOM work out the constructor.

                this.totalStrings = 6;

            }


            ready() {
                super.ready();

                if (!this.string || !this.fret) {
                    this.style.display = 'none';
                }

                // Strings in string property are numerated from 1 to 6 (totalStrings)
                // Finger can only press fret > 0
                if (this.fret < 1 || this.string < 1 || this.string > this.totalStrings) {
                    this.style.display = 'none';
                }

                this.stringIndex = this.totalStrings - this.string;

            }


            connectedCallback() {
                super.connectedCallback();
                // actions on attached...
            }

        }

        // Register custom element definition using standard platform API
        customElements.define(TabChordFingerPosition.is, TabChordFingerPosition);
    </script>

</dom-module>